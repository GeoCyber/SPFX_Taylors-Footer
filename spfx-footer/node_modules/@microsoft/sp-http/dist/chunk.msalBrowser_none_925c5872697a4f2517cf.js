(window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_15_2=window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_15_2||[]).push([[3],{"6RFZ":function(e,t,n){"use strict";n.r(t),n.d(t,"MsalBrowserTokenProvider",function(){return b});var a=n("dHqc"),i=n("UWqr"),r=n("MGiw"),o=n("nUPw"),s=n("+3E/"),c=n("jtSf"),d=n("NS9Q"),l=n("ut3N"),u=function(){function e(e,t){void 0===t&&(t=!1),this.shouldSkipLogging=t,t||(this.qosMonitor=new l._QosMonitor(e))}return e.prototype.writeSuccess=function(e){var t;this.shouldSkipLogging||null===(t=this.qosMonitor)||void 0===t||t.writeSuccess(e)},e.prototype.writeExpectedFailure=function(e,t,n){var a;this.shouldSkipLogging||null===(a=this.qosMonitor)||void 0===a||a.writeExpectedFailure(e,t,n)},e.prototype.writeUnexpectedFailure=function(e,t,n){var a,r;if(!this.shouldSkipLogging){var o=i._BrowserDetection.getBrowserInformation();(null==o?void 0:o.browser)===i._Browser.IE?null===(a=this.qosMonitor)||void 0===a||a.writeExpectedFailure(e,t,n):null===(r=this.qosMonitor)||void 0===r||r.writeUnexpectedFailure(e,t,n)}},e}(),f=n("MDXo"),p=n("EtdL"),m=n("j54J"),_=n("0JfF"),h=function(){function e(){}return e.registerMsalBrowserClient=function(t,n,a){var i=this;this.isClientRegistered(n)||e.msalBrowserClients.set(n,new Promise(function(e){var r=i._createMsalBrowserClient(t,n,a);return r.handleRedirectPromise().then(function(){e(r)}).catch(function(e){new u("MsalBrowserClientManager._handleRedirectPromise").writeUnexpectedFailure(e.errorCode,e)})}))},e.getMsalBrowserClient=function(t,n,a){return this.isClientRegistered(n)||this.registerMsalBrowserClient(t,n,a),e.msalBrowserClients.get(n)},e.isClientRegistered=function(t){return e.msalBrowserClients.has(t)},e._createMsalBrowserClient=function(e,t,n){var a={auth:{authority:e,clientId:t,navigateToLoginRequestUrl:!0,redirectUri:n},system:{loadFrameTimeout:1e4,navigateFrameWait:0}};return p.e.shouldPrintMsalLogsToConsole()&&(a.system.loggerOptions={loggerCallback:p.e.msalLoggerCallback,piiLoggingEnabled:!0,logLevel:m.e.Verbose}),new _.e(a)},e.msalBrowserClients=new Map,e}(),b=function(){function e(e){this._ALLOWED_NETWORK_RETRY_ATTEMPTS=1,this._defaultConfiguration=e,this._redirectManager=new f.e(this._getAuthority(),this._getClientId(),!0),this._shouldPrintDebugLogs=p.e.shouldPrintMsalLogsToConsole(),h.registerMsalBrowserClient(this._getAuthority(),this._getClientId(),this._getRedirectUri())}return e.prototype.getToken=function(e){return this.getTokenData(e).then(function(e){return e.accessToken})},e.prototype.getTokenData=function(e,t,n){var a=this;void 0===t&&(t=!0),void 0===n&&(n=!1),this._shouldPrintDebugLogs=p.e.shouldPrintMsalLogsToConsole();var i=this._generateTelemetryExtraData(e);return this._ensureMsalClientIsInitialized(i).then(function(){return a._logger("getTokenData","Waiting for acquireControl()."),d.e.acquireControl()}).then(function(){a._logger("getTokenData","acquireControl() successful, continuing.");var t,r=new u("MsalBrowserTokenProvider.GetTokenData",n);if(a._defaultConfiguration.spRequestGuid&&(i.CorrelationId=a._defaultConfiguration.spRequestGuid),a._isCurrentUserLoggedInToMsal()){var o=new u("MsalBrowserTokenProvider.AcquireTokenSilent",n),c=a._generateTelemetryExtraData(e);a._logger("getTokenData","User is logged in, calling acquireTokenSilent()."),t=a._acquireTokenSilent(e,n,o,c)}else{var l=new u("MsalBrowserTokenProvider.SsoSilent",n),f=a._generateTelemetryExtraData(e);a._logger("getTokenData","No user is logged in, calling ssoSilent()."),t=a._ssoSilent(e,n,l,f)}return t.then(function(e){return a._logger("getTokenData","Token retrieved. Exiting."),Object(s.t)()||(i.alias=(!!e.fromCache).toString()),r.writeSuccess(i),d.e.releaseControl(),e}).catch(function(t){throw a._logger("getTokenData","Caught an error.",t),a._isErrorEligibleForRedirect(t)&&a._redirectManager.isAllowedToRedirect()&&!n?(a._logger("getTokenData","Calling _loginRedirect()"),r.writeExpectedFailure(t.errorCode,t,i),a._loginRedirect(e,i)):a._isExpectedFailure(t)?r.writeExpectedFailure(t.errorCode,t,i):r.writeUnexpectedFailure(t.errorCode,t,i),a._logger("getTokenData","Throwing the error back to caller. Exiting."),d.e.releaseControl(),t})})},e.prototype._ensureMsalClientIsInitialized=function(e){var t=this;return new Promise(function(n){t._msalBrowserClient?n():h.getMsalBrowserClient(t._getAuthority(),t._getClientId(),t._getRedirectUri()).then(function(e){t._msalBrowserClient=e,n()}).catch(function(t){new u("MsalBrowserTokenProvider._ensureMsalClientIsInitialized").writeUnexpectedFailure("msalClientInit",t,e)})})},e.prototype._acquireTokenSilent=function(e,t,n,a,i){var r,o=this;void 0===i&&(i=0),0===i||(r=new u("MsalBrowserTokenProvider.RetryAcquireTokenSilent",t));var s=this._generateSilentRequest(e,a.CorrelationId);return this._logger("_acquireTokenSilent","Calling acquireTokenSilent with parameters:",s),this._msalBrowserClient.acquireTokenSilent(s).then(function(e){return o._logger("_acquireTokenSilent","Successfully got a token."),a.alias=(!!e.fromCache).toString(),n.writeSuccess(a),null==r||r.writeSuccess(a),e}).catch(function(s){o._logger("_acquireTokenSilent","Caught an error:",s),null==r||r.writeUnexpectedFailure(s.errorCode,s,a);var c=i<o._ALLOWED_NETWORK_RETRY_ATTEMPTS;if(o._isNetworkError(s)&&c)return i++,o._logger("_acquireTokenSilent","Retrying."),o._acquireTokenSilent(e,t,n,a,i);throw o._isExpectedFailure(s)?n.writeExpectedFailure(s.errorCode,s,a):n.writeUnexpectedFailure(s.errorCode,s,a),o._logger("_acquireTokenSilent","Throwing error back to caller."),s})},e.prototype._ssoSilent=function(e,t,n,a,i){var r,o=this;void 0===i&&(i=0),0===i||(r=new u("MsalBrowserTokenProvider.RetrySsoSilent",t));var s=this._generateSsoSilentRequest(e,a.CorrelationId);return this._logger("_ssoSilent","Calling ssoSilent with parameters:",s),this._msalBrowserClient.ssoSilent(s).then(function(e){return o._logger("_ssoSilent","Successfully got a token."),a.alias=(!!e.fromCache).toString(),n.writeSuccess(a),null==r||r.writeSuccess(a),e}).catch(function(s){o._logger("_ssoSilent","Caught an error:",s),null==r||r.writeUnexpectedFailure(s.errorCode,s,a);var c=i<o._ALLOWED_NETWORK_RETRY_ATTEMPTS;if(o._isNetworkError(s)&&c)return i++,o._logger("_ssoSilent","Retrying."),o._ssoSilent(e,t,n,a,i);throw o._isExpectedFailure(s)?n.writeExpectedFailure(s.errorCode,s,a):n.writeUnexpectedFailure(s.errorCode,s,a),o._logger("_ssoSilent","Throwing error back to caller."),s})},e.prototype._loginRedirect=function(e,t){var n=this,a=this._generateLoginRedirectRequest(e,t.CorrelationId);return this._logger("_loginRedirect","Calling prepareForRedirect()."),this._redirectManager.prepareForRedirect(),this._logger("_loginRedirect","Calling loginRedirect."),this._msalBrowserClient.loginRedirect(a).catch(function(e){throw n._logger("_loginRedirect","Failed to redirect with error:",e),new u("MsalBrowserTokenProvider._loginRedirect").writeUnexpectedFailure(e.errorCode,e,t),e})},e.prototype._generateSilentRequest=function(e,t){return{account:this._getCurrentAccount(),authority:this._getAuthority(),correlationId:t,scopes:this._getScopes(e)}},e.prototype._generateSsoSilentRequest=function(e,t){return{authority:this._getAuthority(),correlationId:t,loginHint:this._getLoginHint(),scopes:this._getScopes(e),sid:this._getSessionId()}},e.prototype._generateTelemetryExtraData=function(e){var t=this._defaultConfiguration.servicePrincipalId===r.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,n={alias:"false",CorrelationId:i.Guid.newGuid().toString(),isInternal:t,jsonExtraData:""};return t&&(n.name=e),n},e.prototype._isErrorEligibleForRedirect=function(e){var t=this._redirectManager.hasRedirectAttemptsLeft(),n=this._isInteractionRequiredError(e),a=i._BrowserDetection.getBrowserInformation().browser===i._Browser.IE;return n&&t&&!a},e.prototype._isInteractionRequiredError=function(e){return e instanceof a.e||o.e._isInteractionRequired(e.message,e.errorCode)||"no_account_error"===e.errorCode},e.prototype._isExpectedFailure=function(e){var t=this._isErrorEligibleForRedirect(e),n=o.e._doesAadErrorCodeExist(e.message,r.e.EXPECTED_AAD_ERRORS),a=this._isTabStopTest();return t||n||a},e.prototype._isTabStopTest=function(){return(i._BrowserDetection.getBrowserInformation().userAgent||"").indexOf("TabStop/1.0")>-1},e.prototype._generateLoginRedirectRequest=function(e,t){return{authority:this._getAuthority(),correlationId:t,onRedirectNavigate:this._getOnRedirectNavigate(),redirectUri:this._getRedirectUri(),scopes:this._getScopes(e),state:window.location.href}},e.prototype._getOnRedirectNavigate=function(){var e=this;return function(t){return e._redirectCancelled=!1,i._SPEventManager.instance.raiseEvent(c.n._onBeforeRedirectEventId,new c.e(t,e._cancelRedirect.bind(e))),"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(e._redirectCancelled=!0),e._redirectCancelled&&e._redirectManager.cancelRedirect(),!e._redirectCancelled}},e.prototype._getCurrentAccount=function(){var e=this._defaultConfiguration.userPrincipalName||"",t=this._defaultConfiguration.aadUserId||"",n=this._msalBrowserClient.getAccountByUsername(e),a=this._msalBrowserClient.getAccountByLocalId(t),i=this._msalBrowserClient.getActiveAccount();return n||a?this._logger("_getCurrentAccount","Found an account",{currentAccountByLocalId:a,currentAccountByUsername:n}):this._logger("_getCurrentAccount","No account found"),n||a||i||void 0},e.prototype._cancelRedirect=function(){this._redirectCancelled=!0},e.prototype._isNetworkError=function(e){return o.e._isEndpointsResolutionError(null==e?void 0:e.errorCode)||o.e._isTokenRenewalTimeout(null==e?void 0:e.errorCode)},e.prototype._isCurrentUserLoggedInToMsal=function(){return void 0!==this._getCurrentAccount()},e.prototype._getAuthority=function(){return this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId},e.prototype._getLoginHint=function(){return this._defaultConfiguration.userPrincipalName},e.prototype._getScopes=function(e){return[e+"/.default"]},e.prototype._getSessionId=function(){var e=this._defaultConfiguration.aadSessionId;return!!i.Guid.tryParse(e)||(e=void 0),e?this._logger("_getSessionId","Found session ID",e):this._logger("_getSessionId","No session ID was found"),e},e.prototype._getClientId=function(){return this._defaultConfiguration.servicePrincipalId},e.prototype._getRedirectUri=function(){return this._defaultConfiguration.redirectUri},e.prototype._logger=function(e,t,n){this._shouldPrintDebugLogs&&(console.log("[sp-http][MsalBrowserTokenProvider]["+e+"][1]: "+t),n&&(console.log("[sp-http][MsalBrowserTokenProvider]["+e+"][2] Extra Data: "),console.log(n)))},e}()},EtdL:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.msalLoggerCallback=function(e,t,n){console.log("[sp-http][msal.js]: "+t)},e.shouldPrintMsalLogsToConsole=function(){var e,t="spfx.msal.shouldPrintLogs",n=(null===(e=new URLSearchParams(window.location.search).get("msalLogging"))||void 0===e?void 0:e.toLowerCase())||"";"true"===n?window.sessionStorage.setItem(t,"true"):"false"===n&&window.sessionStorage.removeItem(t);var a=window.sessionStorage.getItem(t)||"";return"true"===n||"true"===a},e}()},MDXo:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(e,t,n){this._STORAGE_KEYS={AUTHORITY:"spfx.msal.authority",CLIENT_ID:"spfx.msal.clientId",CURRENT_REDIRECT_ATTEMPT:"spfx.msal.redirectAttemptNumber",FIRST_REDIRECT_TIME:"spfx.msal.firstRedirectTime",IS_REDIRECT_IN_PROGRESS:"spfx.msal.isRedirectInProgress",REDIRECTED_FROM:"spfx.msal.redirectedFrom",SHOULD_USE_MSAL_BROWSER:"spfx.msal.shouldUseMsalBrowser"},this._authority=e,this._clientId=t,this._shouldUseMsalBrowser=n}return e.prototype.isAllowedToRedirect=function(){return this.hasRedirectAttemptsLeft()&&!this.isRedirectInProgress()},e.prototype.hasRedirectAttemptsLeft=function(){return this.getNumberOfRedirectAttemptsInLastMinute()<e._ALLOWED_REDIRECT_ATTEMPTS},e.prototype.isRedirectInProgress=function(){var e="true"===window.sessionStorage.getItem(this._STORAGE_KEYS.IS_REDIRECT_IN_PROGRESS);return this.getNumberOfRedirectAttemptsInLastMinute()>0&&e},e.prototype.prepareForRedirect=function(){window.sessionStorage.setItem(this._STORAGE_KEYS.IS_REDIRECT_IN_PROGRESS,"true"),this._incrementRedirectAttempts(),window.sessionStorage.setItem(this._STORAGE_KEYS.AUTHORITY,this._authority),window.sessionStorage.setItem(this._STORAGE_KEYS.CLIENT_ID,this._clientId),window.sessionStorage.setItem(this._STORAGE_KEYS.REDIRECTED_FROM,window.location.href),window.sessionStorage.setItem(this._STORAGE_KEYS.SHOULD_USE_MSAL_BROWSER,this._shouldUseMsalBrowser.toString())},e.prototype.cancelRedirect=function(){window.sessionStorage.removeItem(this._STORAGE_KEYS.AUTHORITY),window.sessionStorage.removeItem(this._STORAGE_KEYS.CLIENT_ID),window.sessionStorage.removeItem(this._STORAGE_KEYS.REDIRECTED_FROM),window.sessionStorage.removeItem(this._STORAGE_KEYS.SHOULD_USE_MSAL_BROWSER),window.sessionStorage.removeItem(this._STORAGE_KEYS.IS_REDIRECT_IN_PROGRESS)},e.prototype.getNumberOfRedirectAttemptsInLastMinute=function(){var e=0,t=this._getFirstRedirectTimeFromSessionStorage();if(t){var n=new Date,a=new Date(t);n.getTime()-a.getTime()<6e4&&(e=this._getRedirectAttemptNumberFromSessionStorage())}return e},e.prototype._incrementRedirectAttempts=function(){var e=this.getNumberOfRedirectAttemptsInLastMinute()+1;1===e&&this._setFirstRedirectTimeInSessionStorage(),this._setRedirectAttemptNumberInSessionStorage(e)},e.prototype._getRedirectAttemptNumberFromSessionStorage=function(){var e=window.sessionStorage.getItem(this._STORAGE_KEYS.CURRENT_REDIRECT_ATTEMPT)||"0";return parseInt(e,10)},e.prototype._setRedirectAttemptNumberInSessionStorage=function(e){window.sessionStorage.setItem(this._STORAGE_KEYS.CURRENT_REDIRECT_ATTEMPT,e.toString())},e.prototype._getFirstRedirectTimeFromSessionStorage=function(){return window.sessionStorage.getItem(this._STORAGE_KEYS.FIRST_REDIRECT_TIME)},e.prototype._setFirstRedirectTimeInSessionStorage=function(){var e=new Date;window.sessionStorage.setItem(this._STORAGE_KEYS.FIRST_REDIRECT_TIME,e.toString())},e._ALLOWED_REDIRECT_ATTEMPTS=13,e}()},NS9Q:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.acquireControl=function(){return new Promise(function(t,n){e.isRequestInProgress?(e.requestQueue.push(t),setTimeout(function(){t===e.requestQueue[0]&&(e.isRequestInProgress=!1),t()},e.DEFAULT_AUTO_RESOLVE_TIME)):(e.isRequestInProgress=!0,t())})},e.releaseControl=function(){e.isRequestInProgress=!1;var t=e.requestQueue.shift();t&&t()},e.isRequestInProgress=!1,e.requestQueue=[],e.DEFAULT_AUTO_RESOLVE_TIME=1e4,e}()},nUPw:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("jtSf"),i=n("MGiw"),r=n("UWqr"),o=n("NJ9J"),s=function(){function e(){}return e._handleInteractionRequiredFailures=function(t,n,s){e._doesAadErrorCodeExist(n,i.e.UNRESOLVABLE_AAD_ERROR_CODES)||i.e.RESOLVABLE_ERROR_CODES.forEach(function(e){if(n.indexOf(e)>-1){var i=t._getNavigateUrl(t.RESPONSE_TYPE.TOKEN,s)+"&prompt=select_account";r._SPEventManager.instance.raiseEvent(a.n._tokenAcquisitionEventId,new a.t(o.e,i))}})},e._isInteractionRequired=function(t,n){return!e._doesAadErrorCodeExist(t,i.e.UNRESOLVABLE_AAD_ERROR_CODES)&&i.e.RESOLVABLE_ERROR_CODES.has(n)},e._isTokenRenewalTimeout=function(e){return e===i.e.TOKEN_RENEWAL_TIMEOUT},e._isEndpointsResolutionError=function(e){return e===i.e.ENDPOINTS_RESOLUTION_ERROR},e._doesAadErrorCodeExist=function(e,t){for(var n=0,a=e.match(/(AADSTS)[0-9]+/g)||[];n<a.length;n++){var i=a[n];if(t.has(i))return!0}return!1},e}()}}]);