define("0773bd53-a69e-4293-87e6-ba80ea4d614b_1.15.2",["tslib","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/sp-core-library","@microsoft/sp-diagnostics"],function(n,a,i,r,o,s){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"7Awa":function(e,t){e.exports=i},I6O9:function(e,t){e.exports=r},UWqr:function(e,t){e.exports=o},Z47j:function(e){e.exports=JSON.parse('{"n":"manifestNotFound","e":"extensionInitFailure","t":"extensionLoadFailure"}')},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"BaseExtension",function(){return s}),n.d(t,"ExtensionContext",function(){return c}),n.d(t,"_ExtensionManager",function(){return f});var a=n("17wl"),i=n("2q6Q"),r=n("ut3N"),o=n("7Awa"),s=function(e){function t(){var t=e.call(this)||this;return t._properties={},t}return Object(a.__extends)(t,e),t.prototype._init=function(e,t){var n=this;this._initializeContext(e),this._deserializeProperties(t);var a=this.context.serviceScope.consume(r._logSourceServiceKey)+".Extension.Init";return i._PerformanceLogger.startMarkForComponent(a),this._initializeExtensionType(),this._initPromise=this.onInit().then(function(){i._PerformanceLogger.endMarkForComponent(a),i._PerformanceLogger.logPerformanceMetricToConsole(a,"Extension.Init",n.context.manifest.id,n.context.manifest.alias)}),this._initPromise},t.prototype._initializeExtensionType=function(){},Object.defineProperty(t.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),t.prototype.onInit=function(){return Promise.resolve()},t.prototype._deserializeProperties=function(e){this._properties={};try{e&&""!==e.trim()&&(this._properties=JSON.parse(e))}catch(e){var t=this.context.serviceScope.consume(r._logSourceServiceKey);r._TraceLogger.logError(t,new Error('Failed to deserialize properties for extension "'.concat(this.context.manifest.alias,'"\n          + " with id=').concat(this.context.manifest.id,": ")+e.message))}},t}(o.BaseComponent),c=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t}(o.BaseComponentContext),d=n("UWqr"),l=n("I6O9"),u=n("Z47j"),f=function(){function e(e,t){this._isDisposed=!1,this._serviceScope=e,this._extensions=[]}return e.prototype.createExtension=function(t,n,a){var s=this,c=new r._QosMonitor("Extension.Create",!0),f=l.SPComponentLoader.tryGetManifestById(t);if(!f){var p=new Error(d.Text.format(u.n,t));return c.writeUnexpectedFailure("ManifestNotFound",p,{componentId:t}),Promise.reject(p)}var m=this._createQosExtraData(f);try{var _=d.Guid.newGuid().toString(),h="Extension.".concat(f.id,".").concat(_),b=a({manifest:f,parentServiceScope:this._serviceScope,instanceId:_,loggingTag:h}),g=h+".Extension.Create",v=h+".Extension.ScriptLoad";i._PerformanceLogger.startMarkForComponent(g);var y=void 0;i._PerformanceLogger.startMarkForComponent(v);var S=l.SPComponentLoader.loadComponent(f).then(function(e){i._PerformanceLogger.endMarkForComponent(v),i._PerformanceLogger.logPerformanceMetricToConsole(v,"Extension.ScriptLoad",f.id,f.alias);var a=new(0,e.default);return a._init(b,n).then(function(){return a}).catch(function(e){throw y=new Error(d.Text.format(u.e,t)),c.writeExpectedFailure("ExtensionInitFailure",y,m),y})},function(e){throw y||(y=new Error(d.Text.format(u.t,t)),c.writeExpectedFailure("ExtensionLoadFailure",y,m)),y}).then(function(e){return c.writeSuccess(m),i._PerformanceLogger.endMarkForComponent(g),i._PerformanceLogger.logPerformanceMetricToConsole(v,"Extension.Create",f.id,f.alias),s._extensions.push(e),e});return o._LegacyThirdPartyFabricCoreLoader.forceLoad(f).catch(function(t){return r._TraceLogger.logError(e._logSource,new Error("Failed to load legacy fabric core styles: ".concat(t)))}),S}catch(e){return c.writeUnexpectedFailure("UnhandledCreateError",e,m),Promise.reject(e)}},e.prototype.dispose=function(){this._isDisposed||(this.disposeExtensions(),this._serviceScope=void 0,this._extensions=void 0),this._isDisposed=!0},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.disposeExtensions=function(){for(var t=0,n=this._extensions;t<n.length;t++){var a=n[t];try{a.dispose()}catch(t){var i=a.manifest;r._TraceLogger.logError(e._logSource,new Error('Failed to dispose extension "'.concat(i.alias,'"\n            + " with id=').concat(i.id,": ")+t.message))}}this._extensions=[]},e.prototype._createQosExtraData=function(e){var t={alias:e.alias,isInternal:e.isInternal,manifestId:e.id,extensionType:e.extensionType};return t.teamsHosted=d._BrowserUtilities.isTeamsHosted(),t},e._logSource=r._LogSource.create("ExtensionManager"),e}()},ut3N:function(e,t){e.exports=s}})});